{
  "provider": "Fireworks",
  "summary": {
    "intent_agent": {
      "accuracy": 0.9117647058823529,
      "total": 34,
      "correct": 31,
      "avg_confidence": 0.9441176470588236
    },
    "table_agent": {
      "avg_precision": 0.9558823529411765,
      "avg_recall": 1.0,
      "avg_f1": 0.9705882352941176,
      "total": 34,
      "correct": 31
    },
    "column_prune_agent": {
      "avg_precision": 0.1814587373410903,
      "avg_recall": 0.23529411764705882,
      "avg_f1": 0.19620013780913434,
      "avg_token_savings": 76.06136034126548,
      "total": 34,
      "correct": 1
    },
    "sql_generation_agent": {
      "avg_sql_similarity": 0.8823529411764706,
      "sql_exact_match_rate": 0.6764705882352942,
      "result_match_rate": 0.35294117647058826,
      "total": 34,
      "correct": 23
    },
    "overall": {
      "accuracy": 0.6470588235294118,
      "total": 34,
      "correct": 22
    },
    "latency_metrics": {
      "intent_agent": {
        "avg_latency_ms": 951.7999256358427,
        "min_latency_ms": 731.6231727600098,
        "max_latency_ms": 1297.3902225494385,
        "total_tokens": 11238,
        "tool_calls_rate": 1.0
      },
      "table_agent": {
        "avg_latency_ms": 1041.6950758765724,
        "min_latency_ms": 708.2102298736572,
        "max_latency_ms": 1329.3721675872803,
        "total_tokens": 9662,
        "tool_calls_rate": 1.0
      },
      "column_prune_agent": {
        "avg_latency_ms": 1367.108642385247,
        "min_latency_ms": 930.5751323699951,
        "max_latency_ms": 2226.0048389434814,
        "total_tokens": 42234,
        "tool_calls_rate": 1.0
      },
      "sql_generation_agent": {
        "avg_latency_ms": 1270.2003320058186,
        "min_latency_ms": 660.5682373046875,
        "max_latency_ms": 6916.2421226501465,
        "total_tokens": 21423,
        "tool_calls_rate": 1.0
      }
    }
  },
  "detailed_results": {
    "intent_agent": [
      {
        "question": "What are the names and emails of all active drivers?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "List all trips that were completed",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What are the names of all cities in California?",
        "predicted_workspace": "mobility",
        "expected_workspace": null,
        "correct": true,
        "confidence": 0.9,
        "error": null
      },
      {
        "question": "How many trips does each city have?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the total number of trips in the database?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the average trip amount?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "How many drivers are in each city?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What are the top 5 cities by total trip revenue?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "Which driver has completed the most trips?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the average rating for each driver?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the total revenue generated by each vehicle type?",
        "predicted_workspace": "vehicle_operations",
        "expected_workspace": "mobility",
        "correct": false,
        "confidence": 0.9,
        "error": null
      },
      {
        "question": "How many trips were completed in the last 7 days?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the total revenue from completed trips in December 2025?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "List all trips scheduled for today",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "Show trip details with driver name, customer name, and pickup city",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What are the top 5 customers by total spending?",
        "predicted_workspace": "customer_analytics",
        "expected_workspace": "mobility",
        "correct": false,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "Which vehicle make and model has the most trips?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "List all trips in Seattle with driver names",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "Show all active drivers in New York",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What are the completed trips for Tesla vehicles?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What are the 10 most expensive trips?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "Show the top 5 highest rated drivers",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What are the longest trips by duration?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "Which drivers have completed more than 20 trips?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What cities have more than 100 trips?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "How many trips are in each status?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the average trip amount for each trip status?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the total revenue by payment method?",
        "predicted_workspace": "customer_analytics",
        "expected_workspace": "mobility",
        "correct": false,
        "confidence": 0.9,
        "error": null
      },
      {
        "question": "How many trips used promotions?",
        "predicted_workspace": "promotions",
        "expected_workspace": null,
        "correct": true,
        "confidence": 0.9,
        "error": null
      },
      {
        "question": "What is the total discount applied from promotions?",
        "predicted_workspace": "promotions",
        "expected_workspace": null,
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the average lifetime value of customers?",
        "predicted_workspace": "customer_analytics",
        "expected_workspace": "customer_analytics",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "How many customers signed up in each month?",
        "predicted_workspace": "customer_analytics",
        "expected_workspace": "customer_analytics",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "What is the average trip count per driver?",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      },
      {
        "question": "Show drivers with their total completed trips and average rating",
        "predicted_workspace": "mobility",
        "expected_workspace": "mobility",
        "correct": true,
        "confidence": 0.95,
        "error": null
      }
    ],
    "table_agent": [
      {
        "question": "What are the names and emails of all active drivers?",
        "predicted_tables": [
          "drivers"
        ],
        "expected_tables": [
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "List all trips that were completed",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What are the names of all cities in California?",
        "predicted_tables": [
          "cities"
        ],
        "expected_tables": [
          "cities"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "How many trips does each city have?",
        "predicted_tables": [
          "trips",
          "cities"
        ],
        "expected_tables": [
          "trips",
          "cities"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total number of trips in the database?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average trip amount?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "How many drivers are in each city?",
        "predicted_tables": [
          "cities",
          "drivers"
        ],
        "expected_tables": [
          "cities",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What are the top 5 cities by total trip revenue?",
        "predicted_tables": [
          "trips",
          "cities"
        ],
        "expected_tables": [
          "trips",
          "cities"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "Which driver has completed the most trips?",
        "predicted_tables": [
          "trips",
          "drivers"
        ],
        "expected_tables": [
          "trips",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average rating for each driver?",
        "predicted_tables": [
          "trips",
          "drivers"
        ],
        "expected_tables": [
          "trips",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total revenue generated by each vehicle type?",
        "predicted_tables": [
          "vehicles",
          "trips"
        ],
        "expected_tables": [
          "vehicles",
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "How many trips were completed in the last 7 days?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total revenue from completed trips in December 2025?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "List all trips scheduled for today",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "Show trip details with driver name, customer name, and pickup city",
        "predicted_tables": [
          "customers",
          "trips",
          "cities",
          "drivers"
        ],
        "expected_tables": [
          "customers",
          "trips",
          "cities",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What are the top 5 customers by total spending?",
        "predicted_tables": [
          "customers",
          "trips"
        ],
        "expected_tables": [
          "customers",
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "Which vehicle make and model has the most trips?",
        "predicted_tables": [
          "vehicles",
          "trips"
        ],
        "expected_tables": [
          "vehicles",
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "List all trips in Seattle with driver names",
        "predicted_tables": [
          "trips",
          "cities",
          "drivers"
        ],
        "expected_tables": [
          "trips",
          "cities",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "Show all active drivers in New York",
        "predicted_tables": [
          "cities",
          "drivers"
        ],
        "expected_tables": [
          "cities",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What are the completed trips for Tesla vehicles?",
        "predicted_tables": [
          "vehicles",
          "trips"
        ],
        "expected_tables": [
          "vehicles",
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What are the 10 most expensive trips?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "Show the top 5 highest rated drivers",
        "predicted_tables": [
          "drivers"
        ],
        "expected_tables": [
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What are the longest trips by duration?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "Which drivers have completed more than 20 trips?",
        "predicted_tables": [
          "trips",
          "drivers"
        ],
        "expected_tables": [
          "trips",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What cities have more than 100 trips?",
        "predicted_tables": [
          "trips",
          "cities"
        ],
        "expected_tables": [
          "trips",
          "cities"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "How many trips are in each status?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average trip amount for each trip status?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total revenue by payment method?",
        "predicted_tables": [
          "trips"
        ],
        "expected_tables": [
          "trips"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "How many trips used promotions?",
        "predicted_tables": [
          "trip_promotions",
          "trips"
        ],
        "expected_tables": [
          "trip_promotions"
        ],
        "precision": 0.5,
        "recall": 1.0,
        "f1": 0.6666666666666666,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the total discount applied from promotions?",
        "predicted_tables": [
          "trip_promotions",
          "promotions"
        ],
        "expected_tables": [
          "trip_promotions"
        ],
        "precision": 0.5,
        "recall": 1.0,
        "f1": 0.6666666666666666,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the average lifetime value of customers?",
        "predicted_tables": [
          "customers"
        ],
        "expected_tables": [
          "customers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "How many customers signed up in each month?",
        "predicted_tables": [
          "customers"
        ],
        "expected_tables": [
          "customers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average trip count per driver?",
        "predicted_tables": [
          "trips",
          "drivers"
        ],
        "expected_tables": [
          "drivers"
        ],
        "precision": 0.5,
        "recall": 1.0,
        "f1": 0.6666666666666666,
        "correct": false,
        "error": null
      },
      {
        "question": "Show drivers with their total completed trips and average rating",
        "predicted_tables": [
          "trips",
          "drivers"
        ],
        "expected_tables": [
          "trips",
          "drivers"
        ],
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "correct": true,
        "error": null
      }
    ],
    "column_prune_agent": [
      {
        "question": "What are the names and emails of all active drivers?",
        "table": "drivers",
        "predicted_columns": [
          "first_name",
          "last_name",
          "status",
          "driver_id",
          "email"
        ],
        "expected_columns": [
          "first_name",
          "last_name",
          "email"
        ],
        "precision": 0.6,
        "recall": 1.0,
        "f1": 0.7499999999999999,
        "token_savings_pct": 57.052797478329396,
        "correct": true,
        "error": null
      },
      {
        "question": "List all trips that were completed",
        "table": "trips",
        "predicted_columns": [
          "trip_status",
          "trip_id"
        ],
        "expected_columns": [
          "customer_id",
          "total_amount",
          "trip_id",
          "driver_id"
        ],
        "precision": 0.5,
        "recall": 0.25,
        "f1": 0.3333333333333333,
        "token_savings_pct": 89.593147751606,
        "correct": false,
        "error": null
      },
      {
        "question": "What are the names of all cities in California?",
        "table": "cities",
        "predicted_columns": [
          "city_name",
          "state"
        ],
        "expected_columns": [
          "city_name"
        ],
        "precision": 0.5,
        "recall": 1.0,
        "f1": 0.6666666666666666,
        "token_savings_pct": 70.02518891687657,
        "correct": false,
        "error": null
      },
      {
        "question": "How many trips does each city have?",
        "table": "trips",
        "predicted_columns": [
          "pickup_city_id",
          "trip_id"
        ],
        "expected_columns": [
          "city_name",
          "COUNT(t.trip_id)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 89.33618843683084,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the total number of trips in the database?",
        "table": "trips",
        "predicted_columns": [
          "trip_id"
        ],
        "expected_columns": [
          "COUNT(*)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 94.04710920770879,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the average trip amount?",
        "table": "trips",
        "predicted_columns": [
          "total_amount"
        ],
        "expected_columns": [
          "AVG(total_amount)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 93.96145610278373,
        "correct": false,
        "error": null
      },
      {
        "question": "How many drivers are in each city?",
        "table": "cities",
        "predicted_columns": [
          "city_name",
          "city_id"
        ],
        "expected_columns": [
          "city_name",
          "COUNT(d.driver_id)"
        ],
        "precision": 0.5,
        "recall": 0.5,
        "f1": 0.5,
        "token_savings_pct": 69.52141057934509,
        "correct": false,
        "error": null
      },
      {
        "question": "What are the top 5 cities by total trip revenue?",
        "table": "trips",
        "predicted_columns": [
          "total_amount",
          "pickup_city_id",
          "trip_id"
        ],
        "expected_columns": [
          "city_name",
          "SUM(t.total_amount)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 84.83940042826552,
        "correct": false,
        "error": null
      },
      {
        "question": "Which driver has completed the most trips?",
        "table": "trips",
        "predicted_columns": [
          "trip_status",
          "trip_id",
          "driver_id"
        ],
        "expected_columns": [
          "COUNT(t.trip_id)",
          "first_name || ' ' || d.last_name"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 85.09635974304068,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the average rating for each driver?",
        "table": "trips",
        "predicted_columns": [
          "rating",
          "driver_id"
        ],
        "expected_columns": [
          "AVG(t.rating)",
          "first_name || ' ' || d.last_name"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 89.55032119914347,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the total revenue generated by each vehicle type?",
        "table": "vehicles",
        "predicted_columns": [
          "vehicle_id",
          "vehicle_type"
        ],
        "expected_columns": [
          "SUM(t.total_amount)",
          "vehicle_type"
        ],
        "precision": 0.5,
        "recall": 0.5,
        "f1": 0.5,
        "token_savings_pct": 76.45403377110695,
        "correct": false,
        "error": null
      },
      {
        "question": "How many trips were completed in the last 7 days?",
        "table": "trips",
        "predicted_columns": [
          "dropoff_time",
          "trip_status",
          "trip_id"
        ],
        "expected_columns": [
          "COUNT(*)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 84.83940042826552,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the total revenue from completed trips in December 2025?",
        "table": "trips",
        "predicted_columns": [
          "total_amount",
          "pickup_time",
          "trip_status",
          "trip_id"
        ],
        "expected_columns": [
          "SUM(total_amount)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 80.42826552462526,
        "correct": false,
        "error": null
      },
      {
        "question": "List all trips scheduled for today",
        "table": "trips",
        "predicted_columns": [
          "pickup_time",
          "trip_status",
          "trip_id",
          "dropoff_time"
        ],
        "expected_columns": [
          "customer_id",
          "pickup_time",
          "trip_id",
          "driver_id"
        ],
        "precision": 0.5,
        "recall": 0.5,
        "f1": 0.5,
        "token_savings_pct": 80.1713062098501,
        "correct": false,
        "error": null
      },
      {
        "question": "Show trip details with driver name, customer name, and pickup city",
        "table": "customers",
        "predicted_columns": [
          "first_name",
          "last_name",
          "city_id",
          "customer_id"
        ],
        "expected_columns": [
          "first_name || ' ' || c.last_name",
          "first_name || ' ' || d.last_name",
          "city_name",
          "trip_id",
          "total_amount"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 57.66016713091921,
        "correct": false,
        "error": null
      },
      {
        "question": "What are the top 5 customers by total spending?",
        "table": "customers",
        "predicted_columns": [
          "first_name",
          "last_name",
          "lifetime_value",
          "customer_id"
        ],
        "expected_columns": [
          "first_name || ' ' || c.last_name",
          "SUM(t.total_amount)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 57.195914577530175,
        "correct": false,
        "error": null
      },
      {
        "question": "Which vehicle make and model has the most trips?",
        "table": "vehicles",
        "predicted_columns": [
          "vehicle_id",
          "model",
          "make"
        ],
        "expected_columns": [
          "COUNT(t.trip_id)",
          "model",
          "make"
        ],
        "precision": 0.6666666666666666,
        "recall": 0.6666666666666666,
        "f1": 0.6666666666666666,
        "token_savings_pct": 68.10506566604127,
        "correct": false,
        "error": null
      },
      {
        "question": "List all trips in Seattle with driver names",
        "table": "trips",
        "predicted_columns": [
          "dropoff_city_id",
          "pickup_city_id",
          "trip_id",
          "driver_id"
        ],
        "expected_columns": [
          "total_amount",
          "first_name || ' ' || d.last_name",
          "trip_id"
        ],
        "precision": 0.25,
        "recall": 0.3333333333333333,
        "f1": 0.28571428571428575,
        "token_savings_pct": 80.04282655246253,
        "correct": false,
        "error": null
      },
      {
        "question": "Show all active drivers in New York",
        "table": "cities",
        "predicted_columns": [
          "city_name",
          "city_id",
          "state"
        ],
        "expected_columns": [
          "first_name",
          "last_name",
          "rating",
          "email"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 57.0528967254408,
        "correct": false,
        "error": null
      },
      {
        "question": "What are the completed trips for Tesla vehicles?",
        "table": "vehicles",
        "predicted_columns": [
          "vehicle_id",
          "model",
          "make"
        ],
        "expected_columns": [
          "total_amount",
          "pickup_time",
          "trip_id"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 68.10506566604127,
        "correct": false,
        "error": null
      },
      {
        "question": "What are the 10 most expensive trips?",
        "table": "trips",
        "predicted_columns": [
          "distance_miles",
          "fare_amount",
          "duration_minutes",
          "pickup_time",
          "pickup_city_id",
          "vehicle_id",
          "tip_amount",
          "dropoff_city_id",
          "trip_id",
          "driver_id",
          "total_amount",
          "dropoff_time",
          "customer_id"
        ],
        "expected_columns": [
          "customer_id",
          "total_amount",
          "trip_id",
          "driver_id"
        ],
        "precision": 0.3076923076923077,
        "recall": 1.0,
        "f1": 0.47058823529411764,
        "token_savings_pct": 38.54389721627409,
        "correct": false,
        "error": null
      },
      {
        "question": "Show the top 5 highest rated drivers",
        "table": "drivers",
        "predicted_columns": [
          "first_name",
          "last_name",
          "rating",
          "driver_id"
        ],
        "expected_columns": [
          "rating",
          "total_trips",
          "first_name || ' ' || last_name"
        ],
        "precision": 0.25,
        "recall": 0.3333333333333333,
        "f1": 0.28571428571428575,
        "token_savings_pct": 64.69661150512215,
        "correct": false,
        "error": null
      },
      {
        "question": "What are the longest trips by duration?",
        "table": "trips",
        "predicted_columns": [
          "duration_minutes",
          "pickup_time",
          "pickup_city_id",
          "dropoff_time",
          "trip_id",
          "dropoff_city_id",
          "distance_miles"
        ],
        "expected_columns": [
          "duration_minutes",
          "total_amount",
          "distance_miles",
          "trip_id"
        ],
        "precision": 0.42857142857142855,
        "recall": 0.75,
        "f1": 0.5454545454545454,
        "token_savings_pct": 65.65310492505353,
        "correct": false,
        "error": null
      },
      {
        "question": "Which drivers have completed more than 20 trips?",
        "table": "trips",
        "predicted_columns": [
          "trip_status",
          "trip_id",
          "driver_id"
        ],
        "expected_columns": [
          "COUNT(t.trip_id)",
          "first_name || ' ' || d.last_name"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 85.09635974304068,
        "correct": false,
        "error": null
      },
      {
        "question": "What cities have more than 100 trips?",
        "table": "trips",
        "predicted_columns": [
          "dropoff_city_id",
          "pickup_city_id",
          "trip_id"
        ],
        "expected_columns": [
          "city_name",
          "COUNT(t.trip_id)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 84.53961456102785,
        "correct": false,
        "error": null
      },
      {
        "question": "How many trips are in each status?",
        "table": "trips",
        "predicted_columns": [
          "trip_status",
          "trip_id"
        ],
        "expected_columns": [
          "COUNT(*)",
          "trip_status"
        ],
        "precision": 0.5,
        "recall": 0.5,
        "f1": 0.5,
        "token_savings_pct": 89.593147751606,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the average trip amount for each trip status?",
        "table": "trips",
        "predicted_columns": [
          "total_amount",
          "trip_status",
          "trip_id"
        ],
        "expected_columns": [
          "COUNT(*)",
          "trip_status",
          "AVG(total_amount)"
        ],
        "precision": 0.3333333333333333,
        "recall": 0.3333333333333333,
        "f1": 0.3333333333333333,
        "token_savings_pct": 85.09635974304068,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the total revenue by payment method?",
        "table": "trips",
        "predicted_columns": [
          "total_amount",
          "payment_method",
          "trip_id"
        ],
        "expected_columns": [
          "payment_method",
          "SUM(total_amount)",
          "COUNT(*)"
        ],
        "precision": 0.3333333333333333,
        "recall": 0.3333333333333333,
        "f1": 0.3333333333333333,
        "token_savings_pct": 84.92505353319058,
        "correct": false,
        "error": null
      },
      {
        "question": "How many trips used promotions?",
        "table": "trip_promotions",
        "predicted_columns": [
          "promotion_id",
          "trip_id"
        ],
        "expected_columns": [
          "COUNT(DISTINCT trip_id)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 54.946996466431095,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the total discount applied from promotions?",
        "table": "trip_promotions",
        "predicted_columns": [
          "discount_applied"
        ],
        "expected_columns": [
          "SUM(discount_applied)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 72.43816254416961,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the average lifetime value of customers?",
        "table": "customers",
        "predicted_columns": [
          "lifetime_value",
          "customer_id"
        ],
        "expected_columns": [
          "AVG(lifetime_value)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 76.23026926648096,
        "correct": false,
        "error": null
      },
      {
        "question": "How many customers signed up in each month?",
        "table": "customers",
        "predicted_columns": [
          "signup_date",
          "customer_id"
        ],
        "expected_columns": [
          "strftime('%Y-%m'",
          "COUNT(*)",
          "signup_date)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 76.6016713091922,
        "correct": false,
        "error": null
      },
      {
        "question": "What is the average trip count per driver?",
        "table": "trips",
        "predicted_columns": [
          "trip_id",
          "driver_id"
        ],
        "expected_columns": [
          "AVG(total_trips)"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 89.55032119914347,
        "correct": false,
        "error": null
      },
      {
        "question": "Show drivers with their total completed trips and average rating",
        "table": "trips",
        "predicted_columns": [
          "rating",
          "trip_status",
          "driver_id"
        ],
        "expected_columns": [
          "AVG(t.rating)",
          "COUNT(t.trip_id)",
          "first_name || ' ' || d.last_name"
        ],
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "token_savings_pct": 85.09635974304068,
        "correct": false,
        "error": null
      }
    ],
    "sql_generation_agent": [
      {
        "question": "What are the names and emails of all active drivers?",
        "generated_sql": "SELECT first_name || ' ' || last_name as driver_name, email FROM drivers WHERE status = 'active'",
        "expected_sql": "SELECT first_name, last_name, email FROM drivers WHERE status = 'active'",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 19,
          "expected_rows": 19,
          "column_match": false,
          "actual_columns": [
            "driver_name",
            "email"
          ],
          "expected_columns": [
            "first_name",
            "last_name",
            "email"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "List all trips that were completed",
        "generated_sql": "SELECT * FROM trips WHERE trip_status = 'completed'",
        "expected_sql": "SELECT trip_id, driver_id, customer_id, total_amount FROM trips WHERE trip_status = 'completed'",
        "sql_similarity": 0.6000000000000001,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 250,
          "expected_rows": 250,
          "column_match": false,
          "actual_columns": [
            "payment_method",
            "rating",
            "trip_status",
            "fare_amount",
            "trip_type",
            "duration_minutes",
            "pickup_time",
            "pickup_city_id",
            "vehicle_id",
            "tip_amount",
            "dropoff_time",
            "total_amount",
            "trip_id",
            "driver_id",
            "dropoff_city_id",
            "distance_miles",
            "customer_id"
          ],
          "expected_columns": [
            "customer_id",
            "total_amount",
            "trip_id",
            "driver_id"
          ],
          "value_match": null
        },
        "correct": false,
        "error": null
      },
      {
        "question": "What are the names of all cities in California?",
        "generated_sql": "SELECT city_name FROM cities WHERE state = 'California'",
        "expected_sql": "SELECT city_name FROM cities WHERE state = 'California'",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 2,
          "expected_rows": 2,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "How many trips does each city have?",
        "generated_sql": "SELECT c.city_name, COUNT(t.trip_id) as trip_count FROM cities c JOIN trips t ON c.city_id = t.pickup_city_id GROUP BY c.city_id, c.city_name ORDER BY trip_count DESC",
        "expected_sql": "SELECT c.city_name, COUNT(t.trip_id) as trip_count FROM cities c LEFT JOIN trips t ON c.city_id = t.pickup_city_id GROUP BY c.city_id, c.city_name ORDER BY trip_count DESC",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 10,
          "expected_rows": 10,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total number of trips in the database?",
        "generated_sql": "SELECT COUNT(*) as total_trips FROM trips",
        "expected_sql": "SELECT COUNT(*) as total_trips FROM trips",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average trip amount?",
        "generated_sql": "SELECT AVG(total_amount) as average_trip_amount FROM trips",
        "expected_sql": "SELECT AVG(total_amount) as avg_amount FROM trips",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": false,
          "actual_columns": [
            "average_trip_amount"
          ],
          "expected_columns": [
            "avg_amount"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "How many drivers are in each city?",
        "generated_sql": "SELECT c.city_name, COUNT(d.driver_id) as driver_count FROM cities c LEFT JOIN drivers d ON c.city_id = d.city_id GROUP BY c.city_id, c.city_name ORDER BY driver_count DESC",
        "expected_sql": "SELECT c.city_name, COUNT(d.driver_id) as driver_count FROM cities c LEFT JOIN drivers d ON c.city_id = d.city_id GROUP BY c.city_id, c.city_name ORDER BY driver_count DESC",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 10,
          "expected_rows": 10,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What are the top 5 cities by total trip revenue?",
        "generated_sql": "SELECT c.city_name, SUM(t.total_amount) as total_revenue FROM cities c JOIN trips t ON c.city_id = t.pickup_city_id WHERE t.trip_status = 'completed' GROUP BY c.city_id, c.city_name ORDER BY total_revenue DESC LIMIT 5",
        "expected_sql": "SELECT c.city_name, SUM(t.total_amount) as total_revenue FROM cities c JOIN trips t ON c.city_id = t.pickup_city_id GROUP BY c.city_id, c.city_name ORDER BY total_revenue DESC LIMIT 5",
        "sql_similarity": 0.8,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 5,
          "expected_rows": 5,
          "column_match": true,
          "value_match": false,
          "mismatches": [
            {
              "row": 0,
              "column": "city_name",
              "actual": "Seattle",
              "expected": "Chicago"
            },
            {
              "row": 0,
              "column": "total_revenue",
              "actual": 976.25,
              "expected": 3356.0
            },
            {
              "row": 1,
              "column": "city_name",
              "actual": "Boston",
              "expected": "Seattle"
            },
            {
              "row": 1,
              "column": "total_revenue",
              "actual": 807.54,
              "expected": 3306.01
            },
            {
              "row": 2,
              "column": "city_name",
              "actual": "Chicago",
              "expected": "Portland"
            }
          ]
        },
        "correct": false,
        "error": null
      },
      {
        "question": "Which driver has completed the most trips?",
        "generated_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, COUNT(t.trip_id) as trip_count FROM drivers d JOIN trips t ON d.driver_id = t.driver_id WHERE t.trip_status = 'completed' GROUP BY d.driver_id, d.first_name, d.last_name ORDER BY trip_count DESC LIMIT 1",
        "expected_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, COUNT(t.trip_id) as trip_count FROM drivers d JOIN trips t ON d.driver_id = t.driver_id WHERE t.trip_status = 'completed' GROUP BY d.driver_id, d.first_name, d.last_name ORDER BY trip_count DESC LIMIT 1",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average rating for each driver?",
        "generated_sql": "SELECT d.driver_id, d.first_name || ' ' || d.last_name as driver_name, AVG(t.rating) as average_rating FROM drivers d JOIN trips t ON d.driver_id = t.driver_id WHERE t.rating IS NOT NULL GROUP BY d.driver_id, d.first_name, d.last_name ORDER BY average_rating DESC",
        "expected_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, AVG(t.rating) as avg_rating FROM drivers d LEFT JOIN trips t ON d.driver_id = t.driver_id AND t.rating IS NOT NULL GROUP BY d.driver_id, d.first_name, d.last_name HAVING COUNT(t.rating) > 0 ORDER BY avg_rating DESC",
        "sql_similarity": 0.8,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 50,
          "expected_rows": 50,
          "column_match": false,
          "actual_columns": [
            "average_rating",
            "driver_name",
            "driver_id"
          ],
          "expected_columns": [
            "driver_name",
            "avg_rating"
          ],
          "value_match": null
        },
        "correct": false,
        "error": null
      },
      {
        "question": "What is the total revenue generated by each vehicle type?",
        "generated_sql": "SELECT v.vehicle_type, SUM(t.total_amount) as total_revenue FROM vehicles v JOIN trips t ON v.vehicle_id = t.vehicle_id WHERE t.trip_status = 'completed' GROUP BY v.vehicle_type ORDER BY total_revenue DESC",
        "expected_sql": "SELECT v.vehicle_type, SUM(t.total_amount) as total_revenue FROM vehicles v JOIN trips t ON v.vehicle_id = t.vehicle_id GROUP BY v.vehicle_type ORDER BY total_revenue DESC",
        "sql_similarity": 0.8,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 4,
          "expected_rows": 4,
          "column_match": true,
          "value_match": false,
          "mismatches": [
            {
              "row": 0,
              "column": "total_revenue",
              "actual": 2164.05,
              "expected": 8388.6
            },
            {
              "row": 0,
              "column": "vehicle_type",
              "actual": "sedan",
              "expected": "suv"
            },
            {
              "row": 1,
              "column": "total_revenue",
              "actual": 2024.66,
              "expected": 8345.85
            },
            {
              "row": 1,
              "column": "vehicle_type",
              "actual": "suv",
              "expected": "sedan"
            },
            {
              "row": 2,
              "column": "total_revenue",
              "actual": 1630.46,
              "expected": 7072.25
            }
          ]
        },
        "correct": false,
        "error": null
      },
      {
        "question": "How many trips were completed in the last 7 days?",
        "generated_sql": "SELECT COUNT(*) as trip_count FROM trips WHERE trip_status = 'completed' AND date(dropoff_time) >= date('now', '-7 days')",
        "expected_sql": "SELECT COUNT(*) as trip_count FROM trips WHERE trip_status = 'completed' AND pickup_time >= datetime('now', '-7 days')",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": false,
          "mismatches": [
            {
              "row": 0,
              "column": "trip_count",
              "actual": 65,
              "expected": 71
            }
          ]
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total revenue from completed trips in December 2025?",
        "generated_sql": "SELECT SUM(total_amount) as total_revenue FROM trips WHERE trip_status = 'completed' AND pickup_time >= '2025-12-01' AND pickup_time < '2026-01-01'",
        "expected_sql": "SELECT SUM(total_amount) as total_revenue FROM trips WHERE trip_status = 'completed' AND strftime('%Y-%m', pickup_time) = '2025-12'",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "List all trips scheduled for today",
        "generated_sql": "SELECT * FROM trips WHERE date(pickup_time) = date('now') AND trip_status = 'scheduled'",
        "expected_sql": "SELECT trip_id, driver_id, customer_id, pickup_time FROM trips WHERE trip_status = 'scheduled' AND date(pickup_time) = date('now')",
        "sql_similarity": 0.4,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": false,
          "actual_rows": 0,
          "expected_rows": 6,
          "column_match": null,
          "value_match": null
        },
        "correct": false,
        "error": null
      },
      {
        "question": "Show trip details with driver name, customer name, and pickup city",
        "generated_sql": "SELECT t.trip_id, d.first_name || ' ' || d.last_name as driver_name, c.first_name || ' ' || c.last_name as customer_name, ci.city_name as pickup_city FROM trips t JOIN drivers d ON t.driver_id = d.driver_id JOIN customers c ON t.customer_id = c.customer_id JOIN cities ci ON t.pickup_city_id = ci.city_id",
        "expected_sql": "SELECT t.trip_id, d.first_name || ' ' || d.last_name as driver_name, c.first_name || ' ' || c.last_name as customer_name, ci.city_name as pickup_city, t.total_amount FROM trips t JOIN drivers d ON t.driver_id = d.driver_id JOIN customers c ON t.customer_id = c.customer_id JOIN cities ci ON t.pickup_city_id = ci.city_id LIMIT 10",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": false,
          "actual_rows": 1000,
          "expected_rows": 10,
          "column_match": null,
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What are the top 5 customers by total spending?",
        "generated_sql": "SELECT c.first_name || ' ' || c.last_name as customer_name, SUM(t.total_amount) as total_spent FROM customers c JOIN trips t ON c.customer_id = t.customer_id WHERE t.trip_status = 'completed' GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_spent DESC LIMIT 5",
        "expected_sql": "SELECT c.first_name || ' ' || c.last_name as customer_name, SUM(t.total_amount) as total_spent FROM customers c JOIN trips t ON c.customer_id = t.customer_id WHERE t.trip_status = 'completed' GROUP BY c.customer_id, c.first_name, c.last_name ORDER BY total_spent DESC LIMIT 5",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 5,
          "expected_rows": 5,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "Which vehicle make and model has the most trips?",
        "generated_sql": "SELECT v.make, v.model, COUNT(t.trip_id) as trip_count FROM vehicles v JOIN trips t ON v.vehicle_id = t.vehicle_id GROUP BY v.vehicle_id, v.make, v.model ORDER BY trip_count DESC LIMIT 1",
        "expected_sql": "SELECT v.make, v.model, COUNT(t.trip_id) as trip_count FROM vehicles v JOIN trips t ON v.vehicle_id = t.vehicle_id GROUP BY v.make, v.model ORDER BY trip_count DESC LIMIT 1",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": false,
          "mismatches": [
            {
              "row": 0,
              "column": "trip_count",
              "actual": 28,
              "expected": 69
            },
            {
              "row": 0,
              "column": "model",
              "actual": "C-Class",
              "expected": "Camry"
            },
            {
              "row": 0,
              "column": "make",
              "actual": "Mercedes",
              "expected": "Hyundai"
            }
          ]
        },
        "correct": true,
        "error": null
      },
      {
        "question": "List all trips in Seattle with driver names",
        "generated_sql": "SELECT \n    t.trip_id,\n    d.first_name || ' ' || d.last_name as driver_name,\n    c.city_name as pickup_city\nFROM trips t\nJOIN drivers d ON t.driver_id = d.driver_id\nJOIN cities c ON t.pickup_city_id = c.city_id\nWHERE c.city_name = 'Seattle'",
        "expected_sql": "SELECT t.trip_id, d.first_name || ' ' || d.last_name as driver_name, t.total_amount FROM trips t JOIN drivers d ON t.driver_id = d.driver_id JOIN cities c ON t.pickup_city_id = c.city_id WHERE c.city_name = 'Seattle'",
        "sql_similarity": 0.6000000000000001,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 110,
          "expected_rows": 110,
          "column_match": false,
          "actual_columns": [
            "pickup_city",
            "driver_name",
            "trip_id"
          ],
          "expected_columns": [
            "total_amount",
            "driver_name",
            "trip_id"
          ],
          "value_match": null
        },
        "correct": false,
        "error": null
      },
      {
        "question": "Show all active drivers in New York",
        "generated_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, d.rating, d.total_trips FROM drivers d JOIN cities c ON d.city_id = c.city_id WHERE d.status = 'active' AND c.city_name = 'New York' ORDER BY d.rating DESC",
        "expected_sql": "SELECT d.first_name, d.last_name, d.email, d.rating FROM drivers d JOIN cities c ON d.city_id = c.city_id WHERE d.status = 'active' AND c.city_name = 'New York'",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": false,
          "actual_columns": [
            "driver_name",
            "rating",
            "total_trips"
          ],
          "expected_columns": [
            "first_name",
            "last_name",
            "rating",
            "email"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What are the completed trips for Tesla vehicles?",
        "generated_sql": "SELECT t.trip_id, t.vehicle_id, t.trip_status FROM trips t JOIN vehicles v ON t.vehicle_id = v.vehicle_id WHERE v.make = 'Tesla' AND t.trip_status = 'completed'",
        "expected_sql": "SELECT t.trip_id, t.total_amount, t.pickup_time FROM trips t JOIN vehicles v ON t.vehicle_id = v.vehicle_id WHERE v.make = 'Tesla' AND t.trip_status = 'completed'",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 35,
          "expected_rows": 35,
          "column_match": false,
          "actual_columns": [
            "trip_status",
            "vehicle_id",
            "trip_id"
          ],
          "expected_columns": [
            "total_amount",
            "pickup_time",
            "trip_id"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What are the 10 most expensive trips?",
        "generated_sql": "SELECT trip_id, total_amount FROM trips ORDER BY total_amount DESC LIMIT 10",
        "expected_sql": "SELECT trip_id, driver_id, customer_id, total_amount FROM trips ORDER BY total_amount DESC LIMIT 10",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 10,
          "expected_rows": 10,
          "column_match": false,
          "actual_columns": [
            "total_amount",
            "trip_id"
          ],
          "expected_columns": [
            "customer_id",
            "total_amount",
            "trip_id",
            "driver_id"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "Show the top 5 highest rated drivers",
        "generated_sql": "SELECT first_name || ' ' || last_name as driver_name, rating, total_trips FROM drivers WHERE status = 'active' ORDER BY rating DESC LIMIT 5",
        "expected_sql": "SELECT first_name || ' ' || last_name as driver_name, rating, total_trips FROM drivers WHERE rating IS NOT NULL ORDER BY rating DESC LIMIT 5",
        "sql_similarity": 0.8,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 5,
          "expected_rows": 5,
          "column_match": true,
          "value_match": false,
          "mismatches": [
            {
              "row": 0,
              "column": "driver_name",
              "actual": "Emily Smith",
              "expected": "Amanda Rodriguez"
            },
            {
              "row": 0,
              "column": "rating",
              "actual": 4.92,
              "expected": 4.99
            },
            {
              "row": 0,
              "column": "total_trips",
              "actual": 328,
              "expected": 316
            },
            {
              "row": 1,
              "column": "driver_name",
              "actual": "Robert Rodriguez",
              "expected": "Emily Smith"
            },
            {
              "row": 1,
              "column": "total_trips",
              "actual": 104,
              "expected": 328
            }
          ]
        },
        "correct": false,
        "error": null
      },
      {
        "question": "What are the longest trips by duration?",
        "generated_sql": "",
        "expected_sql": "SELECT trip_id, distance_miles, duration_minutes, total_amount FROM trips WHERE duration_minutes IS NOT NULL ORDER BY duration_minutes DESC LIMIT 5",
        "sql_similarity": 0.0,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "error": "Error code: 400 - {'error': {'object': 'error', 'type': 'invalid_request_error', 'code': 'invalid_request_error', 'message': 'Missing tool calls section markers in: <|tool_calls_section_begin|><|tool_call_begin|>functions.generate_sql:0<|tool_call_argument_begin|>{...'}}"
        },
        "correct": false,
        "error": "Error code: 400 - {'error': {'object': 'error', 'type': 'invalid_request_error', 'code': 'invalid_request_error', 'message': 'Missing tool calls section markers in: <|tool_calls_section_begin|><|tool_call_begin|>functions.generate_sql:0<|tool_call_argument_begin|>{...'}}"
      },
      {
        "question": "Which drivers have completed more than 20 trips?",
        "generated_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, d.total_trips FROM drivers d WHERE d.total_trips > 20 ORDER BY d.total_trips DESC",
        "expected_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, COUNT(t.trip_id) as trip_count FROM drivers d JOIN trips t ON d.driver_id = t.driver_id WHERE t.trip_status = 'completed' GROUP BY d.driver_id, d.first_name, d.last_name HAVING COUNT(t.trip_id) > 20 ORDER BY trip_count DESC",
        "sql_similarity": 0.6000000000000001,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": false,
          "actual_rows": 47,
          "expected_rows": 0,
          "column_match": null,
          "value_match": null
        },
        "correct": false,
        "error": null
      },
      {
        "question": "What cities have more than 100 trips?",
        "generated_sql": "SELECT c.city_name, COUNT(t.trip_id) as trip_count FROM cities c JOIN trips t ON c.city_id = t.pickup_city_id GROUP BY c.city_id, c.city_name HAVING trip_count > 100 ORDER BY trip_count DESC",
        "expected_sql": "SELECT c.city_name, COUNT(t.trip_id) as trip_count FROM cities c JOIN trips t ON c.city_id = t.pickup_city_id GROUP BY c.city_id, c.city_name HAVING COUNT(t.trip_id) > 100 ORDER BY trip_count DESC",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 3,
          "expected_rows": 3,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "How many trips are in each status?",
        "generated_sql": "SELECT trip_status, COUNT(*) as trip_count FROM trips GROUP BY trip_status",
        "expected_sql": "SELECT trip_status, COUNT(*) as count FROM trips GROUP BY trip_status ORDER BY count DESC",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 4,
          "expected_rows": 4,
          "column_match": false,
          "actual_columns": [
            "trip_count",
            "trip_status"
          ],
          "expected_columns": [
            "trip_status",
            "count"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average trip amount for each trip status?",
        "generated_sql": "SELECT trip_status, AVG(total_amount) as average_amount FROM trips GROUP BY trip_status",
        "expected_sql": "SELECT trip_status, AVG(total_amount) as avg_amount, COUNT(*) as count FROM trips GROUP BY trip_status ORDER BY avg_amount DESC",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 4,
          "expected_rows": 4,
          "column_match": false,
          "actual_columns": [
            "average_amount",
            "trip_status"
          ],
          "expected_columns": [
            "trip_status",
            "count",
            "avg_amount"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total revenue by payment method?",
        "generated_sql": "SELECT payment_method, SUM(total_amount) as total_revenue FROM trips WHERE trip_status = 'completed' GROUP BY payment_method ORDER BY total_revenue DESC",
        "expected_sql": "SELECT payment_method, SUM(total_amount) as total_revenue, COUNT(*) as trip_count FROM trips WHERE payment_method IS NOT NULL GROUP BY payment_method ORDER BY total_revenue DESC",
        "sql_similarity": 0.8,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 5,
          "expected_rows": 5,
          "column_match": false,
          "actual_columns": [
            "total_revenue",
            "payment_method"
          ],
          "expected_columns": [
            "total_revenue",
            "payment_method",
            "trip_count"
          ],
          "value_match": null
        },
        "correct": false,
        "error": null
      },
      {
        "question": "How many trips used promotions?",
        "generated_sql": "SELECT COUNT(DISTINCT trip_id) as trips_with_promotions FROM trip_promotions",
        "expected_sql": "SELECT COUNT(DISTINCT trip_id) as trips_with_promotions FROM trip_promotions",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the total discount applied from promotions?",
        "generated_sql": "SELECT SUM(discount_applied) as total_discount FROM trip_promotions",
        "expected_sql": "SELECT SUM(discount_applied) as total_discount FROM trip_promotions",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average lifetime value of customers?",
        "generated_sql": "SELECT AVG(lifetime_value) as avg_lifetime_value FROM customers",
        "expected_sql": "SELECT AVG(lifetime_value) as avg_lifetime_value FROM customers",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "How many customers signed up in each month?",
        "generated_sql": "SELECT strftime('%Y-%m', signup_date) as signup_month, COUNT(*) as customer_count FROM customers WHERE signup_date IS NOT NULL GROUP BY signup_month ORDER BY signup_month DESC",
        "expected_sql": "SELECT strftime('%Y-%m', signup_date) as signup_month, COUNT(*) as customer_count FROM customers WHERE signup_date IS NOT NULL GROUP BY signup_month ORDER BY signup_month DESC",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": true,
        "result_details": {
          "match": true,
          "row_count_match": true,
          "actual_rows": 24,
          "expected_rows": 24,
          "column_match": true,
          "value_match": true,
          "mismatches": []
        },
        "correct": true,
        "error": null
      },
      {
        "question": "What is the average trip count per driver?",
        "generated_sql": "SELECT AVG(total_trips) as avg_trip_count_per_driver FROM drivers",
        "expected_sql": "SELECT AVG(total_trips) as avg_trips FROM drivers",
        "sql_similarity": 1.0,
        "sql_exact_match": true,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": true,
          "actual_rows": 1,
          "expected_rows": 1,
          "column_match": false,
          "actual_columns": [
            "avg_trip_count_per_driver"
          ],
          "expected_columns": [
            "avg_trips"
          ],
          "value_match": null
        },
        "correct": true,
        "error": null
      },
      {
        "question": "Show drivers with their total completed trips and average rating",
        "generated_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, COUNT(t.trip_id) as total_completed_trips, AVG(t.rating) as avg_rating FROM drivers d JOIN trips t ON d.driver_id = t.driver_id WHERE t.trip_status = 'completed' GROUP BY d.driver_id, d.first_name, d.last_name ORDER BY total_completed_trips DESC",
        "expected_sql": "SELECT d.first_name || ' ' || d.last_name as driver_name, COUNT(t.trip_id) as completed_trips, AVG(t.rating) as avg_rating FROM drivers d LEFT JOIN trips t ON d.driver_id = t.driver_id AND t.trip_status = 'completed' AND t.rating IS NOT NULL GROUP BY d.driver_id, d.first_name, d.last_name HAVING COUNT(t.trip_id) > 0 ORDER BY completed_trips DESC LIMIT 10",
        "sql_similarity": 0.8,
        "sql_exact_match": false,
        "result_match": false,
        "result_details": {
          "match": false,
          "row_count_match": false,
          "actual_rows": 50,
          "expected_rows": 10,
          "column_match": null,
          "value_match": null
        },
        "correct": false,
        "error": null
      }
    ],
    "overall": [
      {
        "question": "What are the names and emails of all active drivers?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "List all trips that were completed",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "What are the names of all cities in California?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "How many trips does each city have?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What is the total number of trips in the database?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What is the average trip amount?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "How many drivers are in each city?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What are the top 5 cities by total trip revenue?",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "Which driver has completed the most trips?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What is the average rating for each driver?",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "What is the total revenue generated by each vehicle type?",
        "correct": false,
        "intent_correct": false,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "How many trips were completed in the last 7 days?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What is the total revenue from completed trips in December 2025?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "List all trips scheduled for today",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "Show trip details with driver name, customer name, and pickup city",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What are the top 5 customers by total spending?",
        "correct": false,
        "intent_correct": false,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "Which vehicle make and model has the most trips?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "List all trips in Seattle with driver names",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "Show all active drivers in New York",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What are the completed trips for Tesla vehicles?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What are the 10 most expensive trips?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "Show the top 5 highest rated drivers",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "What are the longest trips by duration?",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "Which drivers have completed more than 20 trips?",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "What cities have more than 100 trips?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "How many trips are in each status?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What is the average trip amount for each trip status?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What is the total revenue by payment method?",
        "correct": false,
        "intent_correct": false,
        "table_correct": true,
        "sql_correct": false
      },
      {
        "question": "How many trips used promotions?",
        "correct": false,
        "intent_correct": true,
        "table_correct": false,
        "sql_correct": true
      },
      {
        "question": "What is the total discount applied from promotions?",
        "correct": false,
        "intent_correct": true,
        "table_correct": false,
        "sql_correct": true
      },
      {
        "question": "What is the average lifetime value of customers?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "How many customers signed up in each month?",
        "correct": true,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": true
      },
      {
        "question": "What is the average trip count per driver?",
        "correct": false,
        "intent_correct": true,
        "table_correct": false,
        "sql_correct": true
      },
      {
        "question": "Show drivers with their total completed trips and average rating",
        "correct": false,
        "intent_correct": true,
        "table_correct": true,
        "sql_correct": false
      }
    ]
  },
  "agent_metrics": {
    "intent_agent": {
      "total_calls": 34,
      "successful_calls": 34,
      "success_rate": 1.0,
      "avg_latency_ms": 951.7999256358427,
      "min_latency_ms": 731.6231727600098,
      "max_latency_ms": 1297.3902225494385,
      "avg_tokens": 330.52941176470586,
      "total_tokens": 11238,
      "tool_calls_usage": {
        "structured_tool_calls": 34,
        "fallback_parsing": 0,
        "tool_calls_rate": 1.0
      },
      "tool_call_accuracy": {
        "accurate_calls": 34,
        "accuracy_rate": 1.0,
        "total_validation_errors": 0,
        "avg_validation_errors_per_call": 0.0
      }
    },
    "table_agent": {
      "total_calls": 34,
      "successful_calls": 34,
      "success_rate": 1.0,
      "avg_latency_ms": 1041.6950758765724,
      "min_latency_ms": 708.2102298736572,
      "max_latency_ms": 1329.3721675872803,
      "avg_tokens": 284.1764705882353,
      "total_tokens": 9662,
      "tool_calls_usage": {
        "structured_tool_calls": 34,
        "fallback_parsing": 0,
        "tool_calls_rate": 1.0
      },
      "tool_call_accuracy": {
        "accurate_calls": 34,
        "accuracy_rate": 1.0,
        "total_validation_errors": 0,
        "avg_validation_errors_per_call": 0.0
      }
    },
    "column_prune_agent": {
      "total_calls": 89,
      "successful_calls": 89,
      "success_rate": 1.0,
      "avg_latency_ms": 1367.108642385247,
      "min_latency_ms": 930.5751323699951,
      "max_latency_ms": 2226.0048389434814,
      "avg_tokens": 474.53932584269666,
      "total_tokens": 42234,
      "tool_calls_usage": {
        "structured_tool_calls": 89,
        "fallback_parsing": 0,
        "tool_calls_rate": 1.0
      },
      "tool_call_accuracy": {
        "accurate_calls": 88,
        "accuracy_rate": 0.9887640449438202,
        "total_validation_errors": 1,
        "avg_validation_errors_per_call": 0.011235955056179775
      }
    },
    "sql_generation_agent": {
      "total_calls": 34,
      "successful_calls": 33,
      "success_rate": 0.9705882352941176,
      "avg_latency_ms": 1270.2003320058186,
      "min_latency_ms": 660.5682373046875,
      "max_latency_ms": 6916.2421226501465,
      "avg_tokens": 649.1818181818181,
      "total_tokens": 21423,
      "tool_calls_usage": {
        "structured_tool_calls": 33,
        "fallback_parsing": 0,
        "tool_calls_rate": 1.0
      },
      "tool_call_accuracy": {
        "accurate_calls": 33,
        "accuracy_rate": 1.0,
        "total_validation_errors": 0,
        "avg_validation_errors_per_call": 0.0
      }
    }
  }
}